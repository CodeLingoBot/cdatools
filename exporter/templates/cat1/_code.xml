<{{- valueOrDefault .TagName "code" -}}
  {{- if hasConcept .PreferredCode}} code='{{- .PreferredCode.Code}}' codeSystem='{{- oidForCodeSystem .PreferredCode.CodeSystem}}'
    {{- if .ValueSetOid }}
      sdtc:valueSet='{{.ValueSetOid}}'
    {{- end -}}
  {{- else}}
    {{- $excludeNullFlavor := valueOrDefault .ExcludeNullFlavor false}}
    {{- if $excludeNullFlavor}}{{- else}} nillFlavor='UNK'
    {{- end}}
  {{- end -}}
>
  {{- $attribute := valueOrDefault .Attribute "codes"}}
  {{- if codeDisplayAttributeIsCodes $attribute}}
    <originalText>{{- .Description}}</originalText>
  {{- end}}
</{{- valueOrDefault .TagName "code"}}>